<!--pages/subPages/parking/nearParking.wxml-->
<view class="box">
  <view class="search-box" bindtap="searchPlace">
    <searchInput bind:clear="initList" disabled placeHolder="请输入您的目的地" value="{{destination}}"></searchInput>
  </view>
  <view class="right-top">
    <view class="icon-box" bindtap="lookRecord">
      <image class="icon-item" mode="widthFix"  src="/pages/image/businessCircle/parking-record.png"></image>
      <text>停车记录</text>
    </view>
  </view>
  <!-- 地图组件 -->
  <my-map height="45vh" id="myMap" bind:regionchange="regionchange">
    <!-- cover-view不能嵌套view标签 -->
    <cover-view class="reset-position" bindtap="resetCurrentPosition">
      <cover-image
        class="reset-icon"
        mode="widthFix"
        src="/pages/image/icons/{{resetActiveIcon ? 'return' : 'return-no'}}.png">
      </cover-image>
    </cover-view>
  </my-map>
  <view class="list-container" style="height: 55vh;">
    <view class="near-top">
      <view class="near-left">
        <view class="left">附近<text class="car-num">{{total}}</text>个停车场</view>
      </view>
      <view class="shuxian"></view>
      <view class="near-right">
        <view class="position flex-center-x">
          <iconfont icon="position" size="30rpx"></iconfont>
          <text class="address text-cut">{{address}}</text>
        </view>
        <view class="refresh" bindtap="initList">
          <iconfont icon="refresh" size="40rpx"></iconfont>
        </view>
      </view>
      
    </view>
    <view class="bottom-box">
      <pull-refresh
        height="100%"
        model:count="{{total}}"
        model:hasMore="{{hasMore}}"
        bind:pullDown="initList"
        bind:reachBottom="upperList"
        model:isRefresh="{{collapse}}">
        <view class="item-box">
          <block wx:for="{{list}}" wx:key="orgIdd">
            <navigator url="./parkingDetail?id={{item.orgId}}&distance={{item.distance}}">
              <business-card
                src="{{item.urlIcon}}"
                row1Title="{{item.orgName}}"
                row2Title="{{item.address}}"
                lat="{{item.latitude}}"
                lng="{{item.longitude}}"
                row2Suffix="{{item.distance}}km">
                <view slot="row3" class="btn-cls">
                  <tag-group
                    tagType="none"
                    translator="{{serviceText}}"
                    showTimer="{{item.businessTimeBucketType == 1}}"
                    orgTags="{{item.orgTags}}">
                  </tag-group>
                </view>
              </business-card>
            </navigator>
          </block>
        </view>
      </pull-refresh>
    </view>
  </view>
</view>

